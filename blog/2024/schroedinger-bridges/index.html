<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="8kVJ5Zz3Dg-s--Msx42GRy0CV_C1LzuCWuH5VQVe57M"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> The Schrödinger Bridge Problem | Fadli Damara </title> <meta name="author" content=" Fadli Damara"> <meta name="description" content="a dynamical formulation of optimal transport"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/bifold.png?d76f67f6a00d2278fc0fd165dd67e824"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://fadlidamara.github.io/blog/2024/schroedinger-bridges/"> <script src="/assets/js/theme.js?134d7c69761bbd6cc6535476d76a0415"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "The Schrödinger Bridge Problem",
            "description": "a dynamical formulation of optimal transport",
            "published": "October 20, 2024",
            "authors": [
              
              {
                "author": "Fadli Damara",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "TU Berlin & BIFOLD",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Fadli Damara </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>The Schrödinger Bridge Problem</h1> <p>a dynamical formulation of optimal transport</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#introduction">Introduction</a> </div> <div> <a href="#optimal-transport">Optimal Transport</a> </div> <ul> <li> <a href="#monge-formulation">Monge formulation</a> </li> <li> <a href="#monge-kantorovitch-formulation">Monge-Kantorovitch formulation</a> </li> <li> <a href="#entropy-regularized-formulation">Entropy-regularized formulation</a> </li> </ul> <div> <a href="#schr%C3%B6dinger-bridges">Schrödinger Bridges</a> </div> <ul> <li> <a href="#from-the-static-formulation-to-the-dynamic-formulation">From the static formulation to the dynamic formulation</a> </li> </ul> <div> <a href="#conclusions">Conclusions</a> </div> </nav> </d-contents> <h2 id="introduction">Introduction</h2> <p>In many problems of the sciences, one core fundamental problem is on optimal transport, which deals with how masses are transported from one to another. One popular application in machine learning is generative modeling, where goal is to generate data from noise. This can be seen as a mass transportation problem where the target distribution (masses) is some data distribution and the initial distribution is Gaussian. Diffusion models are one of the numerous methods proposed motivated by this very idea of optimal transport.</p> <p>Beyond generative modeling, one could also try to transport one data distribution to another. The goal here is to not only generate high quality samples, but also have certain properties of the <em>coupling</em>, as paired training examples are not necessarily available.</p> <div class="row mt-3"> <div class="col-md-5 mx-auto mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/schroedinger-bridges/paired_unpaired2.png" sizes="95vw"></source> <img src="/assets/img/schroedinger-bridges/paired_unpaired2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Paired vs unpaired image datasets. Figure taken from <d-cite key="CycleGAN2017"></d-cite>. </div> <p>Applications naturally arising from this problem is style transfer.</p> <h2 id="optimal-transport">Optimal Transport</h2> <p>Given two probability measures on \(\mathbb{R}^d\), the <strong>Monge formulation</strong> is given by</p> \[\begin{equation} \DeclareMathOperator*{\argmin}{argmin} \\ T^* = \argmin \left\{ \int_{\mathbb{R}^d} c(x, T(x)) d\pi_0(x) \, : \, (T^*)_{\\\#} \pi_0 = \pi_1 \right\} \end{equation}\] <p>where \(T: \mathbb{R}^d \to \mathbb{R}^d\) is a transport map that can move samples using the push-forward operator, \(T_{\\\#} \pi_0\) simply means we move a sample from \(\pi_0\) to target \(\pi_1\). The cost function \(c: \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}_{\geq 0}\) tells us the cost of moving \(x\) using \(T\). In the end, we want that \(T^*\) must push-forward the samples \(\pi_0\) onto \(\pi_1\) with as low cost as possible.</p> <p>The problem with this formulation is that when we change \(\pi_0\) by a little, the optimal \(T^*\) would change a lot. This is undesirable for machine learning, because if we try to learn \(T\) with a neural network, then it will have to learn these very sharp discontinuities. To solve this, some kind of regularization is needed.</p> <p>Let us first introduce the <strong>Monge-Kantorovitch formulation</strong> of the equivalent problem:</p> \[\begin{equation} \DeclareMathOperator*{\argmin}{argmin} \\ \Pi^\star = \argmin \left\{ \int_{\mathbb{R}^d} c(x, y) \, d\Pi(x, y) \, : \, \Pi_0 = \pi_0, \, \Pi_1 = \pi_1 \right\}. \end{equation}\] <p>Here, instead of estimating the mapping \(T\) we try to find a coupling \(\Pi\) that minimizes the cost function \(c\). With this, we now have a stochastic assignment $\Pi(x,\cdot)$ of $x$, instead of a deterministic mapping that sends $x$ to exactly another point \(T(x)\).</p> <p>With this formulation, introducing an entropy regularization becomes straight-forward. The <strong>entropy-regularized</strong> optimal transport problem is:</p> \[\begin{equation} \DeclareMathOperator*{\argmin}{argmin} \\ \label{eq:static} \Pi^\star = \argmin \left\{ \int_{\mathbb{R}^d} c(x, y) \, d\Pi(x, y) - {\color{blue}\lambda H(\Pi)} \, : \, \Pi_0 = \pi_0, \, \Pi_1 = \pi_1 \right\}. \end{equation}\] <p>where $H$ is the entropy and $\lambda$ a regularization parameter. So, not only do we have to minimize the cost, but we also have to maximize the entropy.</p> <h2 id="the-schrödinger-bridge-problem">The Schrödinger Bridge Problem</h2> <p>Thus far, we have only considered a static notion of optimal transport where the mapping sends \(x\) to \(\Pi(x,\cdot)\) in <em>one-shot</em>, i.e. there is no notion of <em>time</em> baked into the formulation. This in turn might make the mapping too hard to learn (think of wasserstein GANs), and hence comes the whole idea of iterative refinement, that fueled the recent success of diffusion models, fundamental to the dynamic formulation.</p> <p>The dynamic formulation is what Schrödinger formulated back in the 1930s, without even having the right “language” at the time<d-footnote>The whole field of information theory was laid by Claude Shannon in 1948 ("A Mathematical Theory of Communication") and the KL divergence a bit later in 1951 ("On Information and Sufficiency").</d-footnote>. Now, the goal is to find a path measure $\mathbb{P}^*$ such that</p> \[\begin{equation} \mathbb{P}^\star = \arg\min \left\{ \mathrm{KL}(\mathbb{P} \| \mathbb{Q}) \, : \, \mathbb{P}_0 = \pi_0, \, \mathbb{P}_1 = \pi_1 \right\}. \end{equation}\] <p>where $\mathbb{Q}$ is a reference path measure, for instance some scaled Brownian motion \((\sqrt{\varepsilon} \mathbf{B}_t)_{t\in[0,1]}\). The path measure $\mathbb{P}^*$ is called a <strong>Schrödinger bridge</strong> and can be thought of a path measure closest to $\mathbb{q}$ in distribution which satisfies the marginal constraints $\mathbb{P}_0 = \pi_0$ and $\mathbb{P}_1 = \pi_1$</p> <div class="row mt-3"> <div class="col-md-5 mx-auto mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/schroedinger-bridges/dynamic.png" sizes="95vw"></source> <img src="/assets/img/schroedinger-bridges/dynamic.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure from the talk of the paper <d-cite key="DSBM"></d-cite> </div> <h2 id="conclusions">Conclusions</h2> <p>The Schrödinger Bridge problem elegantly connects several fundamental concepts in mathematics and machine learning. What started as Schrödinger’s attempts to understand quantum mechanics in the 1930s has evolved into a powerful framework bridging optimal transport, statistical physics, and information theory, with applications reaching far beyond physics, such as machine learning and even economics.</p> <p>The dynamic formulation of optimal transport, as opposed to the static one, provides a key insight into why modern generative models like diffusion models work so well. Instead of trying to learn a one-shot mapping between distributions (GANs, VAEs), they break down the transportation problem into a sequence of smaller steps, which allows iteratively refining the samples over many stages.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2024-11-10-schroedinger-bridges.bib"></d-bibliography> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Fadli Damara. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>